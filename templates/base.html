{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}BestConnect{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <div class="theme-switcher">
        <button onclick="toggleTheme()" id="themeToggle" aria-label="Changer de th√®me">
            <span class="icon">‚òÄÔ∏è</span>
        </button>
    </div>

    <div class="container">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        {% block content %}{% endblock %}
    </div>

    <script>
        // Fonction pour mettre √† jour l'ic√¥ne du th√®me
        function updateThemeIcon(isDark) {
            const themeIcon = document.querySelector('.icon');
            // Afficher l'ic√¥ne du th√®me actuel (soleil pour clair, lune pour sombre)
            themeIcon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
        }

        // Fonction pour basculer le th√®me
        function toggleTheme() {
            const isDark = document.body.classList.contains('dark-theme');
            
            // Mettre √† jour le th√®me imm√©diatement
            document.body.classList.toggle('dark-theme');
            localStorage.setItem('theme', isDark ? 'light' : 'dark');
            
            // Mettre √† jour l'ic√¥ne pour afficher le th√®me actuel
            updateThemeIcon(!isDark);
            
            // D√©sactiver le bouton pendant un court instant pour √©viter les clics multiples
            const button = document.getElementById('themeToggle');
            button.disabled = true;
            setTimeout(() => {
                button.disabled = false;
            }, 300);
        }

        // Appliquer le th√®me initial avant le chargement complet du DOM
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
            // Mettre √† jour l'ic√¥ne une fois que le DOM est charg√©
            document.addEventListener('DOMContentLoaded', () => {
                updateThemeIcon(savedTheme === 'dark');
            });
        })();
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>