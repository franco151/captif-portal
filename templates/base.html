{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}BestConnect{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <div class="theme-switcher">
        <button onclick="toggleTheme()" id="themeToggle" aria-label="Changer de th√®me">
            <span class="icon">‚òÄÔ∏è</span>
        </button>
    </div>

    <div class="container">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        {% block content %}{% endblock %}
    </div>

    <script>
        // Fonction pour mettre √† jour l'ic√¥ne du th√®me
        function updateThemeIcon(isDark) {
            const themeIcon = document.querySelector('.icon');
            if (themeIcon) {
                themeIcon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            }
        }

        // Fonction pour basculer le th√®me - SEULEMENT 2 √âTATS
        function toggleTheme() {
            const isDark = document.body.classList.contains('dark-theme');
            
            // Nettoyer TOUTES les classes de th√®me
            document.body.className = document.body.className.replace(/\b(dark-theme|light-theme|auto-theme)\b/g, '');
            
            if (isDark) {
                // Passer au th√®me clair (pas de classe)
                localStorage.setItem('theme', 'light');
                updateThemeIcon(false);
            } else {
                // Passer au th√®me sombre
                document.body.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark');
                updateThemeIcon(true);
            }
            
            // D√©sactiver le bouton pendant la transition
            const button = document.getElementById('themeToggle');
            if (button) {
                button.disabled = true;
                setTimeout(() => {
                    button.disabled = false;
                }, 300);
            }
        }

        // Appliquer le th√®me initial - SEULEMENT 2 OPTIONS
        (function() {
            // Nettoyer TOUTES les classes de th√®me au d√©marrage
            document.body.className = document.body.className.replace(/\b(dark-theme|light-theme|auto-theme)\b/g, '');
            
            const savedTheme = localStorage.getItem('theme');
            
            // SEULEMENT 2 cas possibles
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
            }
            // Sinon, c'est le th√®me clair par d√©faut (pas de classe)
            
            document.addEventListener('DOMContentLoaded', () => {
                updateThemeIcon(savedTheme === 'dark');
            });
        })();
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>